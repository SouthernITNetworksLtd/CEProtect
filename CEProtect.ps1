
Function Convert-HexToByteArray($hexString)
{
    $bytes = [byte[]]::new($hexString.Length / 2)

    For($i=0; $i -lt $hexString.Length; $i+=2)
    {
        $bytes[$i/2] = [convert]::ToByte($hexString.Substring($i, 2), 16)
    }

    $bytes
}

#Use to get hex string from registry.pol
#$bytes = Get-Content 'C:\Windows\System32\GroupPolicy\Machine\Registry.pol' -Encoding BYTE
#$hexString = ($bytes|ForEach-Object ToString X2) -join ''

$hexString = "50526567010000005B0053006F006600740077006100720065005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00430075007200720065006E007400560065007200730069006F006E005C0050006F006C00690063006900650073005C004500780070006C006F0072006500720000003B004E006F004400720069007600650054007900700065004100750074006F00520075006E0000003B00040000003B00040000003B00FF0000005D005B0053006F006600740077006100720065005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00430075007200720065006E007400560065007200730069006F006E005C0050006F006C00690063006900650073005C004500780070006C006F0072006500720000003B0044006F006E0074005300650074004100750074006F0070006C006100790043006800650063006B0062006F00780000003B00040000003B00040000003B00010000005D005B0053006F006600740077006100720065005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00430075007200720065006E007400560065007200730069006F006E005C0050006F006C00690063006900650073005C004500780070006C006F0072006500720000003B004E006F004100750074006F00720075006E0000003B00040000003B00040000003B00010000005D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00530079007300740065006D004300650072007400690066006900630061007400650073005C0044006900730061006C006C006F007700650064005C0043006500720074006900660069006300610074006500730000003B0000003B00000000003B00000000003B005D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00530079007300740065006D004300650072007400690066006900630061007400650073005C0044006900730061006C006C006F007700650064005C00430052004C00730000003B0000003B00000000003B00000000003B005D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00530079007300740065006D004300650072007400690066006900630061007400650073005C0044006900730061006C006C006F007700650064005C00430054004C00730000003B0000003B00000000003B00000000003B005D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00530079007300740065006D004300650072007400690066006900630061007400650073005C0054007200750073007400650064005000750062006C00690073006800650072005C0043006500720074006900660069006300610074006500730000003B0000003B00000000003B00000000003B005D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00530079007300740065006D004300650072007400690066006900630061007400650073005C0054007200750073007400650064005000750062006C00690073006800650072005C00430052004C00730000003B0000003B00000000003B00000000003B005D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00530079007300740065006D004300650072007400690066006900630061007400650073005C0054007200750073007400650064005000750062006C00690073006800650072005C00430054004C00730000003B0000003B00000000003B00000000003B005D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C004500780070006C006F0072006500720000003B004E006F004100750074006F0070006C006100790066006F0072006E006F006E0056006F006C0075006D00650000003B00040000003B00040000003B00010000005D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00530061006600650072005C0043006F00640065004900640065006E00740069006600690065007200730000003B00440065006600610075006C0074004C006500760065006C0000003B00040000003B00040000003B00000004005D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00530061006600650072005C0043006F00640065004900640065006E00740069006600690065007200730000003B005400720061006E00730070006100720065006E00740045006E00610062006C006500640000003B00040000003B00040000003B00010000005D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00530061006600650072005C0043006F00640065004900640065006E00740069006600690065007200730000003B0050006F006C00690063007900530063006F007000650000003B00040000003B00040000003B00000000005D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00530061006600650072005C0043006F00640065004900640065006E00740069006600690065007200730000003B00450078006500630075007400610062006C0065005400790070006500730000003B00070000003B001E0100003B005A004900500000005700530043000000560042000000550052004C00000053004800530000005300480000005300430052000000520045004700000052004100520000005000590000005000530031000000500049004600000050004300440000004F004300580000004D005300540000004D005300500000004D005300490000004D005300430000004D004400450000004D00440042000000490053005000000049004E005300000049004E0046000000480054004100000048004C005000000047005A00000045005800450000004300520054000000430050004C00000043004F004D00000043004D0044000000430048004D000000420041005400000042004100530000004100440050000000410044004500000037005A0000005D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00530061006600650072005C0043006F00640065004900640065006E0074006900660069006500720073005C0030005C00500061007400680073005C007B00300030006100620033003800350035002D0030003100360064002D0034003100370061002D0038006200640066002D006600310061003700320038003100630030003200350035007D0000003B004C006100730074004D006F0064006900660069006500640000003B000B0000003B00080000003B0069CB4E3A54ABD5015D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00530061006600650072005C0043006F00640065004900640065006E0074006900660069006500720073005C0030005C00500061007400680073005C007B00300030006100620033003800350035002D0030003100360064002D0034003100370061002D0038006200640066002D006600310061003700320038003100630030003200350035007D0000003B004400650073006300720069007000740069006F006E0000003B00010000003B00020000003B0000005D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00530061006600650072005C0043006F00640065004900640065006E0074006900660069006500720073005C0030005C00500061007400680073005C007B00300030006100620033003800350035002D0030003100360064002D0034003100370061002D0038006200640066002D006600310061003700320038003100630030003200350035007D0000003B005300610066006500720046006C0061006700730000003B00040000003B00040000003B00000000005D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00530061006600650072005C0043006F00640065004900640065006E0074006900660069006500720073005C0030005C00500061007400680073005C007B00300030006100620033003800350035002D0030003100360064002D0034003100370061002D0038006200640066002D006600310061003700320038003100630030003200350035007D0000003B004900740065006D00440061007400610000003B00020000003B00300000003B0025007500730065007200700072006F00660069006C00650025005C0044006F0077006E006C006F0061006400730000005D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00530061006600650072005C0043006F00640065004900640065006E0074006900660069006500720073005C0030005C00500061007400680073005C007B00370066003400360063003200660030002D0063003200620036002D0034003000330034002D0039003400350031002D003200390035003100330062006600340031006400650066007D0000003B004C006100730074004D006F0064006900660069006500640000003B000B0000003B00080000003B0077BF8F6053ABD5015D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00530061006600650072005C0043006F00640065004900640065006E0074006900660069006500720073005C0030005C00500061007400680073005C007B00370066003400360063003200660030002D0063003200620036002D0034003000330034002D0039003400350031002D003200390035003100330062006600340031006400650066007D0000003B004400650073006300720069007000740069006F006E0000003B00010000003B00020000003B0000005D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00530061006600650072005C0043006F00640065004900640065006E0074006900660069006500720073005C0030005C00500061007400680073005C007B00370066003400360063003200660030002D0063003200620036002D0034003000330034002D0039003400350031002D003200390035003100330062006600340031006400650066007D0000003B005300610066006500720046006C0061006700730000003B00040000003B00040000003B00000000005D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00530061006600650072005C0043006F00640065004900640065006E0074006900660069006500720073005C0030005C00500061007400680073005C007B00370066003400360063003200660030002D0063003200620036002D0034003000330034002D0039003400350031002D003200390035003100330062006600340031006400650066007D0000003B004900740065006D00440061007400610000003B00020000003B00300000003B0025007500730065007200700072006F00660069006C00650025005C0044006F00630075006D0065006E007400730000005D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00530061006600650072005C0043006F00640065004900640065006E0074006900660069006500720073005C0030005C00500061007400680073005C007B00380031003100650066003900340062002D0065006500640062002D0034003600340036002D0061006400650036002D003500650036003100390030003700610034003500310033007D0000003B004C006100730074004D006F0064006900660069006500640000003B000B0000003B00080000003B00094DC0F553ABD5015D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00530061006600650072005C0043006F00640065004900640065006E0074006900660069006500720073005C0030005C00500061007400680073005C007B00380031003100650066003900340062002D0065006500640062002D0034003600340036002D0061006400650036002D003500650036003100390030003700610034003500310033007D0000003B004400650073006300720069007000740069006F006E0000003B00010000003B00020000003B0000005D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00530061006600650072005C0043006F00640065004900640065006E0074006900660069006500720073005C0030005C00500061007400680073005C007B00380031003100650066003900340062002D0065006500640062002D0034003600340036002D0061006400650036002D003500650036003100390030003700610034003500310033007D0000003B005300610066006500720046006C0061006700730000003B00040000003B00040000003B00000000005D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00530061006600650072005C0043006F00640065004900640065006E0074006900660069006500720073005C0030005C00500061007400680073005C007B00380031003100650066003900340062002D0065006500640062002D0034003600340036002D0061006400650036002D003500650036003100390030003700610034003500310033007D0000003B004900740065006D00440061007400610000003B00020000003B003C0000003B0043003A005C00550073006500720073005C00250075007300650072006E0061006D00650025005C004F006E006500440072006900760065002A0000005D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00530061006600650072005C0043006F00640065004900640065006E0074006900660069006500720073005C0030005C00500061007400680073005C007B00380033003800640065003400380031002D0034006400650062002D0034003400360034002D0061003600310033002D006100620033003700630066006400380030006400310031007D0000003B004C006100730074004D006F0064006900660069006500640000003B000B0000003B00080000003B004AB6D44A53ABD5015D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00530061006600650072005C0043006F00640065004900640065006E0074006900660069006500720073005C0030005C00500061007400680073005C007B00380033003800640065003400380031002D0034006400650062002D0034003400360034002D0061003600310033002D006100620033003700630066006400380030006400310031007D0000003B004400650073006300720069007000740069006F006E0000003B00010000003B00020000003B0000005D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00530061006600650072005C0043006F00640065004900640065006E0074006900660069006500720073005C0030005C00500061007400680073005C007B00380033003800640065003400380031002D0034006400650062002D0034003400360034002D0061003600310033002D006100620033003700630066006400380030006400310031007D0000003B005300610066006500720046006C0061006700730000003B00040000003B00040000003B00000000005D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00530061006600650072005C0043006F00640065004900640065006E0074006900660069006500720073005C0030005C00500061007400680073005C007B00380033003800640065003400380031002D0034006400650062002D0034003400360034002D0061003600310033002D006100620033003700630066006400380030006400310031007D0000003B004900740065006D00440061007400610000003B00020000003B002C0000003B0025007500730065007200700072006F00660069006C00650025005C004400650073006B0074006F00700000005D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00530061006600650072005C0043006F00640065004900640065006E0074006900660069006500720073005C0030005C00500061007400680073005C007B00630065003600650037003000340063002D0066003300300063002D0034003800610061002D0039003300340037002D003700370030003300300063003400310030003400660034007D0000003B004C006100730074004D006F0064006900660069006500640000003B000B0000003B00080000003B00ECA423F7BAAAD5015D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00530061006600650072005C0043006F00640065004900640065006E0074006900660069006500720073005C0030005C00500061007400680073005C007B00630065003600650037003000340063002D0066003300300063002D0034003800610061002D0039003300340037002D003700370030003300300063003400310030003400660034007D0000003B004400650073006300720069007000740069006F006E0000003B00010000003B00020000003B0000005D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00530061006600650072005C0043006F00640065004900640065006E0074006900660069006500720073005C0030005C00500061007400680073005C007B00630065003600650037003000340063002D0066003300300063002D0034003800610061002D0039003300340037002D003700370030003300300063003400310030003400660034007D0000003B005300610066006500720046006C0061006700730000003B00040000003B00040000003B00000000005D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00530061006600650072005C0043006F00640065004900640065006E0074006900660069006500720073005C0030005C00500061007400680073005C007B00630065003600650037003000340063002D0066003300300063002D0034003800610061002D0039003300340037002D003700370030003300300063003400310030003400660034007D0000003B004900740065006D00440061007400610000003B00010000003B00080000003B0044003A005C0000005D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00530061006600650072005C0043006F00640065004900640065006E0074006900660069006500720073005C0030005C00500061007400680073005C007B00640039003300640035003200630062002D0061006200390034002D0034003700310062002D0039003900310064002D006200610035006500300032003000320062003400300034007D0000003B004C006100730074004D006F0064006900660069006500640000003B000B0000003B00080000003B009A5D50FABAAAD5015D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00530061006600650072005C0043006F00640065004900640065006E0074006900660069006500720073005C0030005C00500061007400680073005C007B00640039003300640035003200630062002D0061006200390034002D0034003700310062002D0039003900310064002D006200610035006500300032003000320062003400300034007D0000003B004400650073006300720069007000740069006F006E0000003B00010000003B00020000003B0000005D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00530061006600650072005C0043006F00640065004900640065006E0074006900660069006500720073005C0030005C00500061007400680073005C007B00640039003300640035003200630062002D0061006200390034002D0034003700310062002D0039003900310064002D006200610035006500300032003000320062003400300034007D0000003B005300610066006500720046006C0061006700730000003B00040000003B00040000003B00000000005D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00530061006600650072005C0043006F00640065004900640065006E0074006900660069006500720073005C0030005C00500061007400680073005C007B00640039003300640035003200630062002D0061006200390034002D0034003700310062002D0039003900310064002D006200610035006500300032003000320062003400300034007D0000003B004900740065006D00440061007400610000003B00010000003B00080000003B0045003A005C0000005D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00530061006600650072005C0043006F00640065004900640065006E0074006900660069006500720073005C003200360032003100340034005C00500061007400680073005C007B00310039003100630064003700660061002D0066003200340030002D0034006100310037002D0038003900380036002D003900340064003400380030006100360063003800630061007D0000003B004C006100730074004D006F0064006900660069006500640000003B000B0000003B00080000003B004D9796999090D5015D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00530061006600650072005C0043006F00640065004900640065006E0074006900660069006500720073005C003200360032003100340034005C00500061007400680073005C007B00310039003100630064003700660061002D0066003200340030002D0034006100310037002D0038003900380036002D003900340064003400380030006100360063003800630061007D0000003B004400650073006300720069007000740069006F006E0000003B00010000003B00020000003B0000005D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00530061006600650072005C0043006F00640065004900640065006E0074006900660069006500720073005C003200360032003100340034005C00500061007400680073005C007B00310039003100630064003700660061002D0066003200340030002D0034006100310037002D0038003900380036002D003900340064003400380030006100360063003800630061007D0000003B005300610066006500720046006C0061006700730000003B00040000003B00040000003B00000000005D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00530061006600650072005C0043006F00640065004900640065006E0074006900660069006500720073005C003200360032003100340034005C00500061007400680073005C007B00310039003100630064003700660061002D0066003200340030002D0034006100310037002D0038003900380036002D003900340064003400380030006100360063003800630061007D0000003B004900740065006D00440061007400610000003B00020000003B009A0000003B00250048004B00450059005F004C004F00430041004C005F004D0041004300480049004E0045005C0053004F004600540057004100520045005C004D006900630072006F0073006F00660074005C00570069006E0064006F007700730020004E0054005C00430075007200720065006E007400560065007200730069006F006E005C00530079007300740065006D0052006F006F007400250000005D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00530061006600650072005C0043006F00640065004900640065006E0074006900660069006500720073005C003200360032003100340034005C00500061007400680073005C007B00640032006300330034006100620032002D0035003200390061002D0034003600620032002D0062003200390033002D006600630038003500330066006300650037003200650061007D0000003B004C006100730074004D006F0064006900660069006500640000003B000B0000003B00080000003B0059BE96999090D5015D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00530061006600650072005C0043006F00640065004900640065006E0074006900660069006500720073005C003200360032003100340034005C00500061007400680073005C007B00640032006300330034006100620032002D0035003200390061002D0034003600620032002D0062003200390033002D006600630038003500330066006300650037003200650061007D0000003B004400650073006300720069007000740069006F006E0000003B00010000003B00020000003B0000005D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00530061006600650072005C0043006F00640065004900640065006E0074006900660069006500720073005C003200360032003100340034005C00500061007400680073005C007B00640032006300330034006100620032002D0035003200390061002D0034003600620032002D0062003200390033002D006600630038003500330066006300650037003200650061007D0000003B005300610066006500720046006C0061006700730000003B00040000003B00040000003B00000000005D005B0053006F006600740077006100720065005C0050006F006C00690063006900650073005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00530061006600650072005C0043006F00640065004900640065006E0074006900660069006500720073005C003200360032003100340034005C00500061007400680073005C007B00640032006300330034006100620032002D0035003200390061002D0034003600620032002D0062003200390033002D006600630038003500330066006300650037003200650061007D0000003B004900740065006D00440061007400610000003B00020000003B009E0000003B00250048004B00450059005F004C004F00430041004C005F004D0041004300480049004E0045005C0053004F004600540057004100520045005C004D006900630072006F0073006F00660074005C00570069006E0064006F00770073005C00430075007200720065006E007400560065007200730069006F006E005C00500072006F006700720061006D00460069006C0065007300440069007200250000005D00"

#Create user logon script
Set-Content -Path 'C:\Windows\System32\GroupPolicy\User\Scripts\Logon\DisableAutoPlay.ps1' -Value 'New-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\AutoplayHandlers" -Name "DisableAutoPlay" -Value 1 -PropertyType DWORD -Force | Out-Null' -Force

#Use to write hex string to file
$byteContents = Convert-HexToByteArray $hexString
Set-Content -Path 'C:\Windows\System32\GroupPolicy\Machine\Registry.pol' -Value $byteContents -Encoding BYTE -Force

###

